<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Custom Summaries - Chorus by ZoomInfo</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="../js/salesforce-fields.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f8f9fa;
      color: #374151;
    }
    
    /* Header styles */
    .header {
      background-color: white;
      border-bottom: 1px solid #e5e7eb;
      padding: 0.75rem 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .header-left {
      display: flex;
      align-items: center;
    }
    
    .chorus-logo {
      color: #1976D2;
      font-weight: 600;
      font-size: 1.25rem;
      margin-left: 0.5rem;
    }
    
    .chorus-waveform {
      fill: #1976D2;
    }
    
    .nav-links {
      display: flex;
      margin-left: 2rem;
    }
    
    .nav-link {
      color: #4b5563;
      font-weight: 500;
      padding: 0.5rem 1rem;
      text-decoration: none;
      transition: color 0.2s;
    }
    
    .nav-link:hover {
      color: #1976D2;
    }
    
    .search-container {
      display: flex;
      align-items: center;
      background-color: #f3f4f6;
      border-radius: 0.375rem;
      padding: 0.375rem 0.75rem;
      width: 300px;
    }
    
    .search-input {
      border: none;
      background: transparent;
      outline: none;
      width: 100%;
      margin-left: 0.5rem;
      font-size: 0.875rem;
    }
    
    .search-options {
      color: #9ca3af;
      font-size: 0.875rem;
      border-left: 1px solid #d1d5db;
      padding-left: 0.5rem;
      margin-left: 0.5rem;
    }
    
    .user-avatar {
      width: 2rem;
      height: 2rem;
      border-radius: 9999px;
      background-color: #1976D2;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
      font-size: 0.875rem;
      cursor: pointer;
    }
    
    /* User dropdown styles */
    .user-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      margin-top: 0.5rem;
      width: 240px;
      background-color: white;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      z-index: 50;
      overflow: hidden;
      display: none;
    }
    
    .user-dropdown.active {
      display: block;
    }
    
    .user-dropdown-header {
      padding: 1rem;
      border-bottom: 1px solid #E5E7EB;
    }
    
    .user-dropdown-item {
      display: flex;
      align-items: center;
      padding: 0.75rem 1rem;
      color: #374151;
      transition: background-color 0.2s;
      text-decoration: none;
    }
    
    .user-dropdown-item:hover {
      background-color: #F3F4F6;
    }
    
    .user-dropdown-item svg {
      margin-right: 0.75rem;
      color: #6b7280;
    }

    /* Main layout */
    .main-container {
      display: flex;
      min-height: calc(100vh - 4rem);
    }

    /* Settings sidebar styles */
    .settings-sidebar {
      width: 220px;
      background-color: white;
      border-right: 1px solid #e5e7eb;
      padding: 1.25rem 0.75rem;
    }

    .settings-nav-item {
      display: flex;
      align-items: center;
      padding: 0.5rem 0.75rem;
      color: #4b5563;
      border-radius: 0.25rem;
      margin-bottom: 0.25rem;
      font-size: 0.875rem;
      text-decoration: none;
      cursor: pointer;
    }

    .settings-nav-item:hover {
      background-color: #f3f4f6;
    }

    .settings-nav-item.active {
      background-color: #e3f2fd;
      color: #1976D2;
      font-weight: 500;
    }

    .settings-nav-item-child {
      padding: 0.5rem 0.75rem 0.5rem 2rem;
      color: #4b5563;
      font-size: 0.875rem;
      display: block;
      text-decoration: none;
    }

    .settings-nav-item-child:hover {
      color: #1976D2;
    }

    /* Content area */
    .content-area {
      flex: 1;
      padding: 2rem;
    }

    .page-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: #111827;
      margin-bottom: 0.75rem;
    }

    .page-description {
      color: #4b5563;
      margin-bottom: 2rem;
      max-width: 42rem;
      line-height: 1.5;
    }

    .content-card {
      background-color: white;
      border-radius: 0.5rem;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      padding: 1.5rem;
    }

    .content-description {
      margin-bottom: 1.5rem;
      line-height: 1.5;
    }

    .content-description a {
      color: #1976D2;
      text-decoration: none;
    }

    /* Table styles */
    .summary-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      border-radius: 0.5rem;
      overflow: hidden;
      border: 1px solid #e5e7eb;
    }

    .summary-table th {
      text-align: left;
      padding: 0.75rem 1rem;
      font-weight: 600;
      font-size: 0.875rem;
      color: #111827;
      background-color: #f8fafc;
      border-bottom: 1px solid #e5e7eb;
    }

    .summary-table th:first-child {
      padding-left: 1.25rem;
    }

    .summary-table th:last-child {
      text-align: right;
      padding-right: 1.25rem;
    }

    .summary-table td {
      padding: 0.875rem 1rem;
      border-bottom: 1px solid #e5e7eb;
      vertical-align: middle;
      font-size: 0.875rem;
    }

    .summary-table td:first-child {
      padding-left: 1.25rem;
      font-weight: 500;
    }

    .summary-table td:last-child {
      text-align: right;
      padding-right: 1.25rem;
    }

    .summary-table tr:last-child td {
      border-bottom: none;
    }

    .summary-table tr:hover {
      background-color: #f9fafb;
    }

    .summary-name {
      font-weight: 500;
      color: #111827;
    }

    .summary-description {
      color: #6b7280;
      font-size: 0.875rem;
      margin-top: 0.25rem;
    }

    .summary-badge {
      display: inline-block;
      background-color: #e3f2fd;
      color: #1976D2;
      font-size: 0.75rem;
      font-weight: 500;
      padding: 0.25rem 0.5rem;
      border-radius: 9999px;
      margin-bottom: 0.5rem;
    }

    .salesforce-info {
      display: flex;
      align-items: center;
      font-size: 0.75rem;
      color: #1976D2;
      margin-top: 0.5rem;
    }

    .salesforce-info svg {
      margin-right: 0.25rem;
    }

    /* Toggle switch */
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 48px;
      height: 24px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #e5e7eb;
      transition: .4s;
      border-radius: 24px;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }

    input:checked + .toggle-slider {
      background-color: #1976D2;
    }

    input:checked + .toggle-slider:before {
      transform: translateX(24px);
    }

    .edit-link {
      color: #1976D2;
      font-size: 0.8125rem;
      text-decoration: none;
      display: inline-block;
      padding: 0.25rem 0;
    }

    .edit-link:hover {
      text-decoration: underline;
    }

    /* Toggle switch */
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 40px;
      height: 20px;
      margin-left: 1rem;
      vertical-align: middle;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #e5e7eb;
      transition: .3s;
      border-radius: 20px;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 2px;
      bottom: 2px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    input:checked + .toggle-slider {
      background-color: #1976D2;
    }

    input:checked + .toggle-slider:before {
      transform: translateX(20px);
    }

    .settings-item-info h3 {
      font-weight: 500;
      color: #111827;
      margin-bottom: 0.25rem;
    }

    .settings-item-info p {
      color: #6b7280;
      font-size: 0.875rem;
    }

    /* Button styles */
    .create-button {
      background-color: #2563EB;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      font-weight: 500;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      font-size: 0.875rem;
    }

    .create-button:hover {
      background-color: #1D4ED8;
    }

    .create-button:before {
      content: "+ ";
      margin-right: 0.25rem;
    }

    /* Modal styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.4);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 100;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s, visibility 0.2s;
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-container {
      background-color: white;
      border-radius: 0.25rem;
      width: 100%;
      max-width: 550px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    .modal-header {
      padding: 1rem 1.25rem;
      border-bottom: 1px solid #E5E7EB;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-header h2 {
      font-size: 1rem;
      font-weight: 600;
      color: #111827;
      margin: 0;
    }

    .modal-header button {
      background: none;
      border: none;
      padding: 0;
      cursor: pointer;
      color: #6B7280;
    }

    .modal-header button:hover {
      color: #111827;
    }

    .modal-body {
      padding: 1.25rem;
    }

    .modal-footer {
      padding: 0.75rem 1.25rem;
      border-top: 1px solid #E5E7EB;
      display: flex;
      justify-content: flex-end;
      gap: 0.5rem;
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-label {
      display: block;
      font-weight: 500;
      margin-bottom: 0.5rem;
      color: #374151;
    }

    .form-input {
      width: 100%;
      padding: 0.375rem 0.625rem;
      border: 1px solid #D1D5DB;
      border-radius: 0.25rem;
      font-size: 0.875rem;
      height: 2rem;
    }

    .form-input:focus {
      outline: none;
      border-color: #1976D2;
      box-shadow: 0 0 0 1px #1976D2;
    }

    .form-textarea {
      width: 100%;
      padding: 0.5rem 0.75rem;
      border: 1px solid #D1D5DB;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      min-height: 100px;
      resize: vertical;
    }

    .form-prompt {
      width: 100%;
      padding: 0.5rem 0.75rem;
      border: 1px solid #D1D5DB;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      min-height: 150px;
      font-family: monospace;
      resize: vertical;
    }

    .character-count {
      font-size: 0.75rem;
      color: #6B7280;
      text-align: right;
      margin-top: 0.25rem;
    }

    .preview-section {
      margin-top: 1.5rem;
      padding: 1.5rem;
      background-color: #F9FAFB;
      border-radius: 0.375rem;
      border: 1px solid #E5E7EB;
    }

    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .preview-content {
      background-color: white;
      border: 1px solid #E5E7EB;
      border-radius: 0.375rem;
      padding: 1rem;
      min-height: 150px;
    }

    .preview-loading {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 150px;
    }

    .spinner {
      border: 3px solid #E5E7EB;
      border-radius: 50%;
      border-top: 3px solid #1976D2;
      width: 24px;
      height: 24px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .btn {
      padding: 0.375rem 0.75rem;
      border-radius: 0.25rem;
      font-weight: 500;
      transition: background-color 0.2s;
      cursor: pointer;
      font-size: 0.8125rem;
    }

    .btn-primary {
      background-color: #1976D2;
      color: white;
      border: none;
    }

    .btn-primary:hover {
      background-color: #1565C0;
    }

    .btn-secondary {
      background-color: #F3F4F6;
      color: #374151;
      border: none;
    }

    .btn-secondary:hover {
      background-color: #E5E7EB;
    }

    .btn-disabled {
      background-color: #E5E7EB;
      color: #9CA3AF;
      cursor: not-allowed;
      border: none;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-left">
      <a href="../index.html" class="flex items-center">
        <svg width="24" height="24" viewBox="0 0 24 24" class="chorus-waveform">
          <path d="M3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12Z" fill="none" stroke="currentColor" stroke-width="2" />
          <path d="M7 14C7 14 8.5 16 12 16C15.5 16 17 14 17 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          <path d="M7 10C7 10 8.5 8 12 8C15.5 8 17 10 17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          <path d="M12 7V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
        </svg>
        <span class="chorus-logo">Chorus</span>
      </a>
      
      <div class="nav-links">
        <a href="../index.html" class="nav-link">Home</a>
        <a href="#" class="nav-link">Engagements</a>
        <a href="#" class="nav-link">Deals</a>
        <a href="#" class="nav-link">Playlists</a>
        <div class="relative group">
          <button class="nav-link flex items-center">
            More
            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
        </div>
      </div>
    </div>
    
    <div class="flex items-center">
      <div class="search-container mr-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
        <input type="text" placeholder="Search in Chorus" class="search-input">
        <span class="search-options">Options</span>
      </div>
      
      <div class="relative">
        <div id="user-menu-button" class="user-avatar">
          GP
        </div>
        
        <!-- User dropdown menu -->
        <div id="user-dropdown" class="user-dropdown">
          <div class="user-dropdown-header">
            <div class="font-medium">Gabe Pirela</div>
          </div>
          <a href="/settings/personal-settings.html" class="user-dropdown-item">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            Settings
          </a>
          <a href="#" class="user-dropdown-item">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
            </svg>
            Help Center
          </a>
          <a href="#" class="user-dropdown-item">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
            </svg>
            Live Chat
          </a>
          <a href="#" class="user-dropdown-item">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
            </svg>
            Log Out
          </a>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <div class="main-container">
    <!-- Settings Sidebar -->
    <div class="settings-sidebar">
      <a href="personal-settings.html" class="settings-nav-item">
        Personal Settings
      </a>
      <a href="custom-summaries.html" class="settings-nav-item active">
        Custom Summaries
      </a>
      <div class="settings-nav-item">
        User Management
      </div>
      <a href="#" class="settings-nav-item-child">
        Users
      </a>
      <a href="#" class="settings-nav-item-child">
        Teams and Data Access
      </a>
      <a href="#" class="settings-nav-item-child">
        Roles and Permissions
      </a>
      <a href="#" class="settings-nav-item">
        Integrations
      </a>
      <a href="#" class="settings-nav-item">
        Organization Settings
      </a>
      <a href="#" class="settings-nav-item">
        Trackers
      </a>
      <a href="#" class="settings-nav-item">
        Signals
      </a>
    </div>

    <!-- Content Area -->
    <div class="content-area">
      <h1 class="page-title">Custom Summaries</h1>
      <p class="page-description">
        Configure custom AI-generated summaries for your meetings and calls. These summaries will be automatically generated after each recording and can be customized to focus on specific aspects of your conversations.
      </p>

      <div class="flex justify-end mb-4">
        <button class="create-button">Create New Summary Type</button>
      </div>

      <div class="content-card">

        <!-- Summary Table -->
        <table class="summary-table">
          <thead>
            <tr>
              <th style="width: 60%">Summary Type</th>
              <th>Actions</th>
              <th style="width: 15%">Status</th>
            </tr>
          </thead>
          <tbody>
            <!-- Customer Pain Points -->
            <tr>
              <td>
                <div class="summary-badge">Custom</div>
                <div class="summary-name">Customer Pain Points</div>
                <div class="summary-description">
                  Identifies and summarizes customer challenges, objections, and pain points mentioned during the call.
                </div>
                <div class="salesforce-info">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM9 17H7V10H9V17ZM13 17H11V7H13V17ZM17 17H15V13H17V17Z" />
                  </svg>
                  Writes to Salesforce: Account › Pain Points
                </div>
              </td>
              <td>
                <a href="#" class="edit-link">Edit</a>
              </td>
              <td>
                <label class="toggle-switch">
                  <input type="checkbox" checked>
                  <span class="toggle-slider"></span>
                </label>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Create Summary Modal -->
  <div id="create-summary-modal" class="modal-overlay">
    <div class="modal-container">
      <div class="modal-header">
        <h2>Create New Summary Type</h2>
        <button id="close-modal">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="summary-name" class="form-label">Summary Name</label>
          <input type="text" id="summary-name" class="form-input" placeholder="e.g., Competitive Analysis">
        </div>
        
        <div class="form-group">
          <label for="summary-description" class="form-label">Description</label>
          <textarea id="summary-description" class="form-textarea" placeholder="Describe what this summary will focus on..."></textarea>
        </div>
        
        <div class="form-group">
          <label for="summary-prompt" class="form-label">AI Prompt</label>
          <textarea id="summary-prompt" class="form-prompt" placeholder="Provide instructions for the AI to generate this summary..."></textarea>
          <div class="character-count">0/2000 characters</div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Execution Mode</label>
          <div class="mt-2">
            <div class="flex items-center mb-2">
              <input type="radio" id="execution-auto" name="execution-mode" value="automatic" class="mr-2" checked>
              <label for="execution-auto" class="text-sm text-gray-600">Automatic post-processing</label>
              <span class="ml-2 text-xs text-gray-500">(Generate summary automatically after each call)</span>
            </div>
            <div class="flex items-center">
              <input type="radio" id="execution-manual" name="execution-mode" value="manual" class="mr-2">
              <label for="execution-manual" class="text-sm text-gray-600">On-demand user trigger</label>
              <span class="ml-2 text-xs text-gray-500">(Generate summary only when manually requested)</span>
            </div>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Aggregation Scope</label>
          <div class="mt-2">
            <div class="flex items-center mb-2">
              <input type="radio" id="scope-individual" name="aggregation-scope" value="individual" class="mr-2" checked>
              <label for="scope-individual" class="text-sm text-gray-600">Per individual call</label>
              <span class="ml-2 text-xs text-gray-500">(Generate summary for just the current call)</span>
            </div>
            <div class="flex items-center">
              <input type="radio" id="scope-opportunity" name="aggregation-scope" value="opportunity" class="mr-2">
              <label for="scope-opportunity" class="text-sm text-gray-600">Across all opportunity interactions</label>
              <span class="ml-2 text-xs text-gray-500">(Aggregate data across all calls related to an opportunity)</span>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Salesforce Integration</label>
          <div class="flex items-center mt-2">
            <input type="checkbox" id="salesforce-integration" class="mr-2">
            <label for="salesforce-integration" class="text-sm text-gray-600">Write summary to Salesforce</label>
          </div>
          
          <div id="salesforce-fields" class="mt-3 pl-6" style="display: none;">
            <div class="form-group">
              <label for="salesforce-object" class="form-label">Object</label>
              <select id="salesforce-object" class="form-input">
                <option value="account">Account</option>
                <option value="opportunity">Opportunity</option>
                <option value="contact">Contact</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="salesforce-field" class="form-label">Field</label>
              <select id="salesforce-field" class="form-input">
                <option value="">Select a field...</option>
              </select>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="cancel-button">Cancel</button>
        <button class="btn btn-primary" id="create-button">Create Summary</button>
      </div>
    </div>
  </div>

  <script>
    // Store summary configurations
    const summaries = [
      {
        id: 'customer-pain-points',
        name: 'Customer Pain Points',
        description: 'Identifies and summarizes customer challenges, objections, and pain points mentioned during the call.',
        prompt: 'Analyze the conversation and identify all customer pain points, challenges, and objections. For each:\n1. Describe the specific issue or challenge\n2. Note the context in which it was mentioned\n3. Include any emotional indicators or emphasis\n4. Highlight potential impact on the customer\n\nOrganize these points by priority/severity if possible.',
        executionMode: 'automatic',
        aggregationScope: 'opportunity',
        isDefault: false,
        salesforceIntegration: true,
        salesforceObject: 'account',
        salesforceField: 'pain_points',
        enabled: true
      }
    ];

    // User dropdown toggle
    const userMenuButton = document.getElementById('user-menu-button');
    const userDropdown = document.getElementById('user-dropdown');

    userMenuButton.addEventListener('click', () => {
      userDropdown.classList.toggle('active');
    });

    document.addEventListener('click', (event) => {
      if (!userMenuButton.contains(event.target) && !userDropdown.contains(event.target)) {
        userDropdown.classList.remove('active');
      }
    });

    // Modal elements
    const modal = document.getElementById('create-summary-modal');
    const modalTitle = modal.querySelector('.modal-header h2');
    const submitButton = document.getElementById('create-button');
    const closeModal = document.getElementById('close-modal');
    const cancelButton = document.getElementById('cancel-button');
    
    // Form elements
    const summaryNameInput = document.getElementById('summary-name');
    const summaryDescriptionInput = document.getElementById('summary-description');
    const summaryPromptInput = document.getElementById('summary-prompt');
    const salesforceIntegrationCheckbox = document.getElementById('salesforce-integration');
    const salesforceFields = document.getElementById('salesforce-fields');
    const salesforceObjectSelect = document.getElementById('salesforce-object');
    const salesforceFieldSelect = document.getElementById('salesforce-field');
    
    // Track current mode and summary being edited
    let isEditMode = false;
    let currentSummaryId = null;

    // Modal functionality
    const createButton = document.querySelector('.create-button');
    
    createButton.addEventListener('click', () => {
      // Reset form and set to create mode
      resetForm();
      isEditMode = false;
      currentSummaryId = null;
      modalTitle.textContent = 'Create New Summary Type';
      submitButton.textContent = 'Create Summary';
      modal.classList.add('active');
    });

    // Add event listeners to edit links
    document.querySelectorAll('.edit-link').forEach((link, index) => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const summary = summaries[index];
        openEditModal(summary);
      });
    });

    function openEditModal(summary) {
      // Set edit mode and current summary
      isEditMode = true;
      currentSummaryId = summary.id;
      
      // Update modal title and button
      modalTitle.textContent = 'Edit Summary Type';
      submitButton.textContent = 'Update Summary';
      
      // Populate form fields
      summaryNameInput.value = summary.name;
      summaryDescriptionInput.value = summary.description;
      summaryPromptInput.value = summary.prompt;
      salesforceIntegrationCheckbox.checked = summary.salesforceIntegration;
      
      // Set execution mode radio buttons
      document.querySelector(`input[name="execution-mode"][value="${summary.executionMode || 'automatic'}"]`).checked = true;
      
      // Set aggregation scope radio buttons
      document.querySelector(`input[name="aggregation-scope"][value="${summary.aggregationScope || 'individual'}"]`).checked = true;
      
      // Update character count
      const count = summaryPromptInput.value.length;
      document.querySelector('.character-count').textContent = `${count}/2000 characters`;
      
      // Handle Salesforce fields
      if (summary.salesforceIntegration) {
        salesforceFields.style.display = 'block';
        salesforceObjectSelect.value = summary.salesforceObject;
        
        // Populate field options based on selected object
        populateSalesforceFields(summary.salesforceObject);
        
        // Set the field value after options are populated
        setTimeout(() => {
          salesforceFieldSelect.value = summary.salesforceField;
        }, 0);
      } else {
        salesforceFields.style.display = 'none';
      }
      
      // Show modal
      modal.classList.add('active');
    }

    function resetForm() {
      summaryNameInput.value = '';
      summaryDescriptionInput.value = '';
      summaryPromptInput.value = '';
      
      // Reset radio buttons to defaults
      document.getElementById('execution-auto').checked = true;
      document.getElementById('scope-individual').checked = true;
      
      // Reset Salesforce fields
      salesforceIntegrationCheckbox.checked = false;
      salesforceFields.style.display = 'none';
      salesforceObjectSelect.value = 'account';
      salesforceFieldSelect.innerHTML = '<option value="">Select a field...</option>';
      document.querySelector('.character-count').textContent = '0/2000 characters';
    }

    closeModal.addEventListener('click', () => {
      modal.classList.remove('active');
    });

    cancelButton.addEventListener('click', () => {
      modal.classList.remove('active');
    });

    // Form submission
    submitButton.addEventListener('click', () => {
      // Validate form
      if (!validateForm()) {
        return;
      }
      
      // Get form data
      const formData = {
        name: summaryNameInput.value,
        description: summaryDescriptionInput.value,
        prompt: summaryPromptInput.value,
        executionMode: document.querySelector('input[name="execution-mode"]:checked').value,
        aggregationScope: document.querySelector('input[name="aggregation-scope"]:checked').value,
        salesforceIntegration: salesforceIntegrationCheckbox.checked,
        salesforceObject: salesforceIntegrationCheckbox.checked ? salesforceObjectSelect.value : '',
        salesforceField: salesforceIntegrationCheckbox.checked ? salesforceFieldSelect.value : '',
        enabled: true
      };
      
      if (isEditMode) {
        // Update existing summary
        const summaryIndex = summaries.findIndex(s => s.id === currentSummaryId);
        if (summaryIndex !== -1) {
          // Preserve id and isDefault properties
          formData.id = summaries[summaryIndex].id;
          formData.isDefault = summaries[summaryIndex].isDefault;
          summaries[summaryIndex] = formData;
          
          // Update UI
          updateSummaryUI(summaryIndex, formData);
        }
      } else {
        // Create new summary
        const newSummary = {
          ...formData,
          id: 'summary-' + Date.now(),
          isDefault: false
        };
        
        summaries.push(newSummary);
        
        // Add new row to table
        addSummaryRow(newSummary);
      }
      
      // Close modal
      modal.classList.remove('active');
    });

    function validateForm() {
      // Check required fields
      if (!summaryNameInput.value.trim()) {
        alert('Please enter a summary name');
        return false;
      }
      
      if (!summaryDescriptionInput.value.trim()) {
        alert('Please enter a description');
        return false;
      }
      
      if (!summaryPromptInput.value.trim()) {
        alert('Please enter an AI prompt');
        return false;
      }
      
      if (summaryPromptInput.value.length > 2000) {
        alert('AI prompt exceeds maximum length of 2000 characters');
        return false;
      }
      
      if (salesforceIntegrationCheckbox.checked) {
        if (!salesforceFieldSelect.value) {
          alert('Please select a Salesforce field');
          return false;
        }
      }
      
      return true;
    }

    function updateSummaryUI(index, summary) {
      const rows = document.querySelectorAll('.summary-table tbody tr');
      if (index < rows.length) {
        const row = rows[index];
        
        // Update name and description
        row.querySelector('.summary-name').textContent = summary.name;
        row.querySelector('.summary-description').textContent = summary.description;
        
        // Update Salesforce info if applicable
        const salesforceInfo = row.querySelector('.salesforce-info');
        if (summary.salesforceIntegration) {
          if (salesforceInfo) {
            // Update existing Salesforce info
            const objectLabel = salesforceObjectSelect.options[salesforceObjectSelect.selectedIndex].text;
            const fieldLabel = salesforceFieldSelect.options[salesforceFieldSelect.selectedIndex].text;
            salesforceInfo.querySelector('span').textContent = `Writes to Salesforce: ${objectLabel} › ${fieldLabel}`;
          } else {
            // Add Salesforce info
            const objectLabel = salesforceObjectSelect.options[salesforceObjectSelect.selectedIndex].text;
            const fieldLabel = salesforceFieldSelect.options[salesforceFieldSelect.selectedIndex].text;
            const infoDiv = document.createElement('div');
            infoDiv.className = 'salesforce-info';
            infoDiv.innerHTML = `
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor">
                <path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM9 17H7V10H9V17ZM13 17H11V7H13V17ZM17 17H15V13H17V17Z" />
              </svg>
              <span>Writes to Salesforce: ${objectLabel} › ${fieldLabel}</span>
            `;
            row.querySelector('td:first-child').appendChild(infoDiv);
          }
        } else if (salesforceInfo) {
          // Remove Salesforce info if it exists but is no longer needed
          salesforceInfo.remove();
        }
      }
    }

    function addSummaryRow(summary) {
      const tbody = document.querySelector('.summary-table tbody');
      const row = document.createElement('tr');
      
      // Create badge class based on default status
      const badgeClass = summary.isDefault ? 'Default' : 'Custom';
      
      // Create Salesforce info if applicable
      let salesforceInfoHTML = '';
      if (summary.salesforceIntegration) {
        const objectLabel = salesforceObjectSelect.options[salesforceObjectSelect.selectedIndex].text;
        const fieldLabel = salesforceFieldSelect.options[salesforceFieldSelect.selectedIndex].text;
        salesforceInfoHTML = `
          <div class="salesforce-info">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor">
              <path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM9 17H7V10H9V17ZM13 17H11V7H13V17ZM17 17H15V13H17V17Z" />
            </svg>
            <span>Writes to Salesforce: ${objectLabel} › ${fieldLabel}</span>
          </div>
        `;
      }
      
      row.innerHTML = `
        <td>
          <div class="summary-badge">${badgeClass}</div>
          <div class="summary-name">${summary.name}</div>
          <div class="summary-description">
            ${summary.description}
          </div>
          ${salesforceInfoHTML}
        </td>
        <td>
          <a href="#" class="edit-link">Edit</a>
        </td>
        <td>
          <label class="toggle-switch">
            <input type="checkbox" ${summary.enabled ? 'checked' : ''}>
            <span class="toggle-slider"></span>
          </label>
        </td>
      `;
      
      // Add event listener to the new edit link
      row.querySelector('.edit-link').addEventListener('click', (e) => {
        e.preventDefault();
        openEditModal(summary);
      });
      
      tbody.appendChild(row);
    }

    // Salesforce integration toggle
    salesforceIntegrationCheckbox.addEventListener('change', () => {
      if (salesforceIntegrationCheckbox.checked) {
        salesforceFields.style.display = 'block';
        // Populate fields for the default selected object
        populateSalesforceFields(salesforceObjectSelect.value);
      } else {
        salesforceFields.style.display = 'none';
      }
    });

    // Character count for prompt
    summaryPromptInput.addEventListener('input', () => {
      const count = summaryPromptInput.value.length;
      document.querySelector('.character-count').textContent = `${count}/2000 characters`;
      
      if (count > 2000) {
        document.querySelector('.character-count').style.color = '#EF4444';
      } else {
        document.querySelector('.character-count').style.color = '#6B7280';
      }
    });

    // Salesforce object field population
    salesforceObjectSelect.addEventListener('change', () => {
      populateSalesforceFields(salesforceObjectSelect.value);
    });

    function populateSalesforceFields(objectType) {
      // Clear existing options
      salesforceFieldSelect.innerHTML = '<option value="">Select a field...</option>';
      
      // Get fields for selected object
      const fields = getSalesforceFields(objectType);
      
      // Populate fields dropdown
      fields.forEach(field => {
        const option = document.createElement('option');
        option.value = field.value;
        option.textContent = field.label;
        salesforceFieldSelect.appendChild(option);
      });
    }

    // Function to get fields based on object type
    function getSalesforceFields(objectType) {
      // This would normally come from an API or imported module
      // For now, we'll use a simple mapping
      const fieldMappings = {
        account: [
          { value: 'description', label: 'Description' },
          { value: 'pain_points', label: 'Pain Points' },
          { value: 'notes', label: 'Notes' }
        ],
        opportunity: [
          { value: 'description', label: 'Description' },
          { value: 'next_steps', label: 'Next Steps' },
          { value: 'competitive_analysis', label: 'Competitive Analysis' }
        ],
        contact: [
          { value: 'notes', label: 'Notes' },
          { value: 'background', label: 'Background' }
        ]
      };
      
      return fieldMappings[objectType] || [];
    }
  </script>
